<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feeder Analytics | Login</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Supabase OAuth -->
  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

    const SUPABASE_URL = "https://ylkmlkelbpxyqauaqcfk.supabase.co";
    const SUPABASE_KEY = "sb_publishable_72WfxwzjZxDAQmSWVR3_3w_a58rn57e";
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    window.loginWithMicrosoft = async () => {
      const redirectURL =
        "https://elbertdeguzman-cyber.github.io/feeder-analytics-ui/dashboard.html";

      const { data, error } = await supabase.auth.signInWithOAuth({
        provider: "azure",
        options: {
          scopes: "openid email profile",
          redirectTo: redirectURL
        },
      });

      if (error) {
        console.error("OAuth Error:", error);
        alert("Login failed. Please try again or contact STI IT.");
      }
    };
  </script>

  <style>
    .fade-rise {
      animation: fadeRise 0.8s ease forwards;
      opacity: 0;
      transform: translateY(20px);
    }
    @keyframes fadeRise {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body class="bg-gradient-to-br from-slate-900 to-slate-700 min-h-screen flex items-center justify-center p-6">

  <div class="bg-white/10 backdrop-blur-xl rounded-2xl shadow-2xl max-w-md w-full p-10 text-center fade-rise border border-white/20">

    <img src="assets/images/logo.png" class="h-14 mx-auto mb-6" />

    <h1 class="text-3xl font-bold text-white mb-2">Feeder Analytics</h1>
    <p class="text-slate-300 mb-8">STI College O365 Login</p>

    <button
      onclick="loginWithMicrosoft()"
      class="w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-lg transition-all flex items-center justify-center gap-3"
    >
      <img src="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg" class="h-5" />
      Sign in with Microsoft
    </button>

    <p class="text-slate-300 text-xs mt-6">Only authorized STI personnel may access this system.</p>

  </div>

</body>
</html>
